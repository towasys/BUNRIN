(()=>{var t={752:function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0});var a,i=n(997),o=function(){function t(){}return t.assert=function(t,e){if(!t)throw new Error("error: ".concat(JSON.stringify(e)))},t.ENABLE=!0,t}(),l=new(function(){function t(){this.content_map_by_data_ulid=new Map,this.content_map_by_line_ulid=new Map}return t.prototype.get_by_data_ulid=function(t){var e=this.content_map_by_data_ulid.get(t);if(!e)throw"there is no content as ".concat(t);return e},t.prototype.get_by_line_ulid=function(t){var e=this.content_map_by_line_ulid.get(t);if(!e)throw"no content";return e},t.prototype.set=function(t){this.content_map_by_data_ulid.set(t.data_ulid,t)},t.prototype.set_by_line_ulid=function(t,e){this.content_map_by_line_ulid.set(t,e)},t}()),c=function(){function t(t,e,n,r){void 0===n&&(n=Date.now()),void 0===r&&(r=Date.now()),this.text=t,this.data_ulid=e,this.parents=[],this.children=[],this.created_at_timestamp=n,this.edited_at_timestamp=r}return t.prototype.edit=function(t,e){void 0===e&&(e=Date.now()),this.text=t,this.edited_at_timestamp=e},t.prototype.appendChild=function(t){this.children.push(t),t.parents.push(this)},t.prototype.insertBefore=function(t,e){v(t),v(e),o.assert(!!t,t),o.assert(!!e,e),t.parents.push(this);for(var n=0;n<this.children.length;n++)if(this.children[n]==e)return void this.children.splice(n,0,t);throw"there is no target content"},t.prototype.remove_parent=function(t){for(var e=0;e<this.parents.length;e++)if(this.parents[e].data_ulid==t.data_ulid){this.parents.splice(e,1);break}},t.prototype.remove_child=function(t){for(var e=0;e<this.children.length;e++)if(this.children[e].data_ulid==t.data_ulid){this.remove_child_at(e);break}},t.prototype.remove_child_at=function(t){this.children[t].remove_parent(this),this.children.splice(t,1)},t.prototype.toString=function(){return"{text:".concat(this.text,", data_ulid:").concat(this.data_ulid,", parents:").concat(this.parents,", children:").concat(this.children,", created_at_timestamp:").concat(this.created_at_timestamp,", edited_at_timestamp:").concat(this.edited_at_timestamp,"}")},t}();function u(t){var e,n,a=t.target.parentElement;if(!a)throw"no div_content";!function(t){var e,n,a=t.getAttribute("data_ulid"),i=document.querySelectorAll('[data_ulid="'.concat(a,'"]')),o=t.querySelector(".text_content").textContent;try{for(var l=r(i),c=l.next();!c.done;c=l.next()){var u=c.value;t!=u&&(u.querySelector(".text_content").textContent=o)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}}(a);var i=a.getAttribute("data_ulid");if(!i)throw"no data_ulid in div_content";!function(t,e){l.get_by_data_ulid(t).edit(e)}(i,null!==(n=null===(e=a.querySelector(".text_content"))||void 0===e?void 0:e.textContent)&&void 0!==n?n:"")}function d(t){var e=t.target.parentElement;switch(t.code){case"Tab":t.preventDefault(),t.shiftKey?function(t,e){!function(t){var e;if(null===(e=t.parentElement)||void 0===e?void 0:e.classList.contains("content")){for(var n=t.nextSibling;null!=n;n=t.nextSibling)h(n)&&f(n);var r=t.parentElement;p(r.parentElement);var a=r.nextElementSibling,i=r.parentElement,o=Array.from(r.children).filter((function(t){return t.classList.contains("content")})).indexOf(t);i.insertBefore(t,a);var l=g(t),c=g(r),u=g(i);if(a){var d=g(a);u.insertBefore(l,d)}else u.appendChild(l);c.remove_child_at(o),console.log(u.children.map((function(t){return t.data_ulid}))),t.querySelector(".text_content").focus(),console.log("content:".concat(l.data_ulid)),v(l),p(t),p(t),p(r),p(i)}}(t)}(e):function(t,e){f(t)}(e);break;case"ArrowUp":t.preventDefault(),function(t,e){!function(t){var e=_(t);e&&s(e)}(t)}(e);break;case"ArrowDown":t.preventDefault(),function(t,e){!function(t){var e=function(t){var e=t.querySelector(".content");if(e)return e;if(t.nextElementSibling)return t.nextElementSibling;for(var n=t.parentElement;null!=n;n=n.parentElement)if(null!=n.nextElementSibling&&h(n.nextElementSibling))return n.nextElementSibling;return null}(t);null!=e&&s(e)}(t)}(e);break;case"Enter":t.preventDefault(),function(t,e){var n=t.querySelector(".text_content").textContent;if(n.includes("\n")){var r=n.split("\n"),a=r[0],o=r[1];!function(t,e,n,r){var a=e.querySelector("span.text_content");if(!a)throw'there is no <span class="text_content"';a.textContent=n;var o=e.getAttribute("data_ulid");l.get_by_data_ulid(o).text=n;var u=(0,i.ulid)(),d=new c(r,u);l.set(d);var f=g(t);f&&(e.nextSibling?f.insertBefore(d,g(e.nextSibling)):f.appendChild(d));var p=m(d,u);console.log("div_content.nextElementSibling",e.nextElementSibling),t.insertBefore(p,e.nextElementSibling),s(p)}(t.parentElement,t,a,o)}e.preventDefault()}(e,t);break;case"Backspace":!function(t,e){var n;0==(null===(n=t.textContent)||void 0===n?void 0:n.length)&&(e.preventDefault(),function(t){var e,n,r=g(t),a=t.parentElement;if(a.classList.contains("content")){var i=a.getAttribute("data_ulid"),o=l.get_by_data_ulid(i),c=null===(e=t.parentElement)||void 0===e?void 0:e.querySelectorAll(".content"),u=Array.from(c).indexOf(t);o.remove_child_at(u)}var d=a.getAttribute("data_ulid");d&&(o=l.get_by_data_ulid(d),r.remove_parent(o));var f=_(t);null===(n=t.parentElement)||void 0===n||n.removeChild(t),f&&s(f)}(t))}(e,t)}}function s(t){var e=t.querySelector(".text_content");if(!e)throw'there is no <span class="text_content>';e.focus()}function f(t){var e=t.previousSibling;if(e&&h(e)){var n=g(e),r=g(t);console.log(r),v(r),p(t);var a=t.parentElement;if(a){var i=g(a),o=Array.from(a.children).filter((function(t){return t.classList.contains("content")})).indexOf(t);i.remove_child_at(o)}n.appendChild(r),e.appendChild(t),t.querySelector(".text_content").focus(),console.log(r),v(r),p(t),p(t.parentElement),p(a),p(e)}}function p(t){var e,n;if(o.ENABLE){var a=Array.from(t.children).filter((function(t){return t.classList.contains("content")})),i=g(t);try{for(var l=r(a),c=l.next();!c.done;c=l.next()){var u=c.value,d=a.indexOf(u),s=g(u);o.assert(i.children[d]==s,"content_children:[".concat(i.children.map((function(t){return t.data_ulid})),"], elem_children:[").concat(a.map((function(t){return t.getAttribute("data_ulid")})),"]"))}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}}}function v(t){var e,n,a,i;if(o.ENABLE){try{for(var l=r(t.children),c=l.next();!c.done;c=l.next()){var u=c.value;o.assert(u.parents.includes(t),{content:t.toString(),child:u.toString(),message:"child has not content as parents"})}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}try{for(var d=r(t.parents),s=d.next();!s.done;s=d.next()){var f=s.value;o.assert(f.children.includes(t),{content:t.toString(),parent:f.toString(),message:"child has not content as parents"})}}catch(t){a={error:t}}finally{try{s&&!s.done&&(i=d.return)&&i.call(d)}finally{if(a)throw a.error}}}}function h(t){return!!t.classList.contains("content")}function _(t){var e,n=t.previousElementSibling;if(!n)throw"there is no previousElementSibling";if(n.classList.contains("content")){var r=n.querySelectorAll(".content");return r.length>0?r[r.length-1]:n}return(null===(e=t.parentElement)||void 0===e?void 0:e.classList.contains("content"))?t.parentElement:null}function m(t,e){var n=document.createElement("div");n.classList.add("content"),n.setAttribute("data_ulid",e),n.addEventListener("dragover",E,!1),n.addEventListener("dragleave",(function(t){t.preventDefault(),t.target.classList.remove("dragover")}),!1),n.addEventListener("drop",w,!1);var r=document.createElement("span");r.classList.add("dot"),r.setAttribute("draggable","true"),r.addEventListener("dragstart",x,!1),r.onclick=y,n.appendChild(r);var a=document.createElement("span");return a.onkeydown=d,a.onkeyup=u,a.setAttribute("contenteditable","true"),a.setAttribute("spellcheck","false"),a.classList.add("text_content"),a.textContent=t.text,n.appendChild(a),n}function y(t){b(g(S(t.target)))}function g(t){o.assert(!!t,t);var e=t.getAttribute("data_ulid");return o.assert(e.length>0,e),l.get_by_data_ulid(e)}function b(t){var e,n,a,i,o,l,c=document.querySelector("#page_container");c.innerHTML="";var u=document.createElement("div");u.id="page_title",u.setAttribute("data_ulid",t.data_ulid),c.appendChild(u);var d=document.createElement("h1");d.textContent=t.text,d.setAttribute("contenteditable","true"),d.setAttribute("spellcheck","false"),u.appendChild(d);try{for(var s=r(t.children),f=s.next();!f.done;f=s.next()){var p=f.value,v=m(p,p.data_ulid);c.appendChild(v);try{for(var h=(a=void 0,r(p.children)),_=h.next();!_.done;_=h.next()){var y=_.value,g=m(y,y.data_ulid);v.appendChild(g)}}catch(t){a={error:t}}finally{try{_&&!_.done&&(i=h.return)&&i.call(h)}finally{if(a)throw a.error}}}}catch(t){e={error:t}}finally{try{f&&!f.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}var b=document.querySelector("section#parent_container");b.innerHTML="";try{for(var x=r(t.parents),w=x.next();!w.done;w=x.next()){var E=w.value,S=m(E,E.data_ulid);b.appendChild(S)}}catch(t){o={error:t}}finally{try{w&&!w.done&&(l=x.return)&&l.call(x)}finally{if(o)throw o.error}}}function x(t){var e=t.target;if(!e.parentElement)throw"there is no dot_span.parentElement";a=e.parentElement}function w(t){t.preventDefault(),t.stopPropagation();var e=t.target;e.classList.remove("dragover"),e.classList.contains("content")||(e=S(t.target));var n=g(a),r=m(n,n.data_ulid);e.appendChild(r);var i=g(e),o=r.getAttribute("data_ulid"),c=l.get_by_data_ulid(o);i.appendChild(c)}function E(t){t.preventDefault();var e=t.target;e.classList.contains("content")&&e.classList.add("dragover"),e.classList.contains("text_content")&&e.classList.add("dragover")}function S(t){var e;if(!t.parentElement)throw"no element.parentElement";return(null===(e=t.parentElement)||void 0===e?void 0:e.classList.contains("content"))?t.parentElement:S(t.parentElement)}!function(){var t=new c("Home",(0,i.ulid)());l.set(t),b(t);var e=document.querySelector("#page_title");e.onkeydown=function(t){switch(t.keyCode){case 9:t.preventDefault();break;case 13:!function(t,e){var n,r=(0,i.ulid)(),a=new c("",r);l.set(a),g(t).appendChild(a);var o=m(a,r);null===(n=document.querySelector("#page_title"))||void 0===n||n.appendChild(o),o.querySelector(".text_content").focus(),e.preventDefault(),e.stopPropagation()}(e,t)}}}()},997:(t,e,n)=>{"use strict";function r(t){var e=new Error(t);return e.source="ulid",e}n.r(e),n.d(e,{decodeTime:()=>f,detectPrng:()=>p,encodeRandom:()=>s,encodeTime:()=>d,factory:()=>v,incrementBase32:()=>c,monotonicFactory:()=>h,randomChar:()=>u,replaceCharAt:()=>l,ulid:()=>_});var a="0123456789ABCDEFGHJKMNPQRSTVWXYZ",i=a.length,o=Math.pow(2,48)-1;function l(t,e,n){return e>t.length-1?t:t.substr(0,e)+n+t.substr(e+1)}function c(t){for(var e=void 0,n=t.length,o=void 0,c=void 0,u=i-1;!e&&n-- >=0;){if(o=t[n],-1===(c=a.indexOf(o)))throw r("incorrectly encoded string");c!==u?e=l(t,n,a[c+1]):t=l(t,n,a[0])}if("string"==typeof e)return e;throw r("cannot increment this string")}function u(t){var e=Math.floor(t()*i);return e===i&&(e=i-1),a.charAt(e)}function d(t,e){if(isNaN(t))throw new Error(t+" must be a number");if(t>o)throw r("cannot encode time greater than "+o);if(t<0)throw r("time must be positive");if(!1===Number.isInteger(t))throw r("time must be an integer");for(var n=void 0,l="";e>0;e--)l=a.charAt(n=t%i)+l,t=(t-n)/i;return l}function s(t,e){for(var n="";t>0;t--)n=u(e)+n;return n}function f(t){if(26!==t.length)throw r("malformed ulid");var e=t.substr(0,10).split("").reverse().reduce((function(t,e,n){var o=a.indexOf(e);if(-1===o)throw r("invalid character found: "+e);return t+o*Math.pow(i,n)}),0);if(e>o)throw r("malformed ulid, timestamp too large");return e}function p(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments[1];e||(e="undefined"!=typeof window?window:null);var a=e&&(e.crypto||e.msCrypto);if(a)return function(){var t=new Uint8Array(1);return a.getRandomValues(t),t[0]/255};try{var i=n(788);return function(){return i.randomBytes(1).readUInt8()/255}}catch(t){}if(t){try{console.error("secure crypto unusable, falling back to insecure Math.random()!")}catch(t){}return function(){return Math.random()}}throw r("secure crypto unusable, insecure Math.random not allowed")}function v(t){return t||(t=p()),function(e){return isNaN(e)&&(e=Date.now()),d(e,10)+s(16,t)}}function h(t){t||(t=p());var e=0,n=void 0;return function(r){if(isNaN(r)&&(r=Date.now()),r<=e){var a=n=c(n);return d(e,10)+a}e=r;var i=n=s(16,t);return d(r,10)+i}}var _=v()},788:()=>{}},e={};function n(r){var a=e[r];if(void 0!==a)return a.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(752)})();